<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ApproVideo - Appropriate Technology Videos for the DIY Sector - September 2024</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="./videoData2b.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="stylesheet" href="style8.css">
    <style>
   

    </style>
  
    <div class="embossed-background"></div>



    <div class="absolute top-2 right-2 flex items-center space-x-2">
        <button id="add-content" class="theme-toggle2 text-2xl">
            <i class="fas fa-plus-circle" id="theme-toggle-light-icon2"></i>
            <i class="fas fa-plus-circle hidden" id="theme-toggle-dark-icon2"></i>
        </button>

        <button id="theme-toggle" class="theme-toggle text-2xl">
            <i class="fas fa-sun" id="theme-toggle-light-icon"></i>
            <i class="fas fa-moon hidden" id="theme-toggle-dark-icon"></i>
        </button>
    </div>




    
    <div class="floating-icons">
        <a href="#" class="flex items-center px-3 py-2 rounded-md hover:bg-opacity-20 hover:bg-white" data-category="Drinking Water"><i class="fas fa-tint fa-3x floating-icon" style="--i:1;"></i></a>
        <i class="fas fa-recycle fa-3x floating-icon" style="--i:2;"></i>
        <i class="fas fa-solar-panel fa-3x floating-icon" style="--i:3;"></i>
        <i class="fas fa-heartbeat fa-3x floating-icon" style="--i:4;"></i>
    </div>
        
    <div class="header relative overflow-hidden">

   <div class="container mx-auto flex justify-center space-x-8">




<div class="group">                    
                    <a href="#" class="flex items-center px-4 py-3 rounded-md hover:bg-opacity-20 hover:bg-white" data-category="Shelter">                        
                        <i class="fas fa-home mr-2"></i>                    
                    </a>                    
                    <div class="drop-up-menu absolute hidden group-hover:block bg-white shadow-md rounded-md mt-2 py-2 z-10">                        
                        <a href="#" class="drop-up-item category-link" data-category="Temporary Shelter">Temporary Shelter</a>                        
                        <a href="#" class="drop-up-item category-link" data-category="Permanent Housing">Permanent Housing</a>                        
                        <a href="#" class="drop-up-item category-link" data-category="Insulation">Insulation</a>                        
                        <a href="#" class="drop-up-item category-link" data-category="Ventilation">Ventilation</a>                        
                        <a href="#" class="drop-up-item category-link" data-category="Natural Building">Natural Building</a>                    
                    </div>                
                </div>                       
                <div class="group">                    
                    <a href="#" class="flex items-center px-3 py-2 rounded-md hover:bg-opacity-20 hover:bg-white" data-category="Water">                        
                        <i class="fas fa-tint mr-2"></i>                    
                    </a>                    
                    <div class="drop-up-menu">                        
                        <a href="#"  class="drop-up-item category-link" data-category="Water Filtration">Filtration</a>                        
                        <a href="#"  class="drop-up-item category-link" data-category="Urban Water">*Urban</a>                        
                        <a href="#" class="drop-up-item category-link" data-category="Water Purification">Purification</a>                        
                        <a href="#" class="drop-up-item category-link" data-category="Drinking Water Storage">Storage</a>                        
                        <a href="#" class="drop-up-item category-link" data-category="Water Distribution">Distribution</a>                    
                    </div>                
                </div>                
                <div class="group">                    
                    <a href="#" class="flex items-center px-3 py-2 rounded-md hover:bg-opacity-20 hover:bg-white" data-category="Waste Management">                        
                        <i class="fas fa-recycle mr-2"></i>                    
                    </a>                    
                    <div class="drop-up-menu">                        
                        <a href="#" class="drop-up-item" data-category="Composting">Composting</a>                        
                        <a href="#" class="drop-up-item" data-category="Recycling">Recycling</a>                        
                        <a href="#" class="drop-up-item" data-category="Upcycling">Upcycling</a>                        
                        <a href="#" class="drop-up-item" data-category="Hygiene">Health & Hygiene</a>                        
                        <a href="#" class="drop-up-item" data-category="Zero Waste">Zero Waste</a>   
                        <a href="#" class="drop-up-item" data-category="Producer Responsibility">Write a Letter:  Producer Responsibility for Plastics</a>  
                        <a href="#" class="drop-up-item" data-category="PFOA/PFOS Elimination">Write a Letter: Eliminate PFOA/PFOS in Food Packaging</a>                 
                    </div>                
                </div>                           
                ApproVideo                       
                <div class="group">                    
                    <a href="#" class="flex items-center px-3 py-2 rounded-md hover:bg-opacity-20 hover:bg-white" data-category="Energy">                        
                        <i class="fas fa-solar-panel mr-2"></i>                                            
                    </a>                    
                    <div class="drop-up-menu">u                        
                        <a href="#" class="drop-up-item" data-category="Solar">Solar</a>                        
                        <a href="#" class="drop-up-item" data-category="Wind">Wind</a>                        
                        <a href="#" class="drop-up-item" data-category="Hydropower">Hydropower</a>                        
                        <a href="#" class="drop-up-item" data-category="Biogas">Biogas</a>                        
                        <a href="#" class="drop-up-item" data-category="Motors">Motors</a>                        
                        <a href="#" class="drop-up-item" data-category="Wiring">Wiring</a>                        
                        <a href="#" class="drop-up-item" data-category="Compressors">Compressors</a>                        
                        <a href="#" class="drop-up-item" data-category="HVAC">HVAC</a>                        
                        <a href="#" class="drop-up-item" data-category="Plumbing">Plumbing</a>                        
                        <a href="#" class="drop-up-item" data-category="Design">Design</a>                    
                    </div>                
                </div>                
                <div class="group">                    
                    <a href="#" class="flex items-center px-3 py-2 rounded-md hover:bg-opacity-20 hover:bg-white" data-category="Appropriate Tech.">                        
                        <i class="fas fa-heartbeat mr-2"></i>                                           
                    </a>                    
                    <div class="drop-up-menu">                        
                        <a href="#" class="drop-up-item" data-category="Agriculture">Agriculture</a>                        
                        <a href="#" class="drop-up-item" data-category="Construction">Construction</a>                        
                        <a href="#" class="drop-up-item" data-category="People">People</a>                        
                        <a href="#" class="drop-up-item" data-category="Healthcare">Healthcare</a>                        
                        <a href="#" class="drop-up-item" data-category="ptsd">PTSD Care</a>                        
                        <a href="#" class="drop-up-item" data-category="field-medicine">Field Medicine</a>                        
                        <a href="#" class="drop-up-item" data-category="Education">Education</a>                    
                    </div>                
                </div>            
                <div class="group">                
                    <a href="#" class="flex items-center px-4 py-3 rounded-md hover:bg-opacity-20 hover:bg-white" data-category="Agronomy">                    
                        <i class="fas fa-seedling mr-2"></i>                
                    </a>                
                    <div class="drop-up-menu">                    
                        <a href="#" class="drop-up-item">Integrated Pest Management</a>                    
                        <a href="#" class="drop-up-item" data-category="Soil Improvement">Soil Improvement</a>                    
                        <a href="#" class="drop-up-item" data-category="Cover Cropping">Cover Cropping</a>                    
                        <a href="#" class="drop-up-item" data-category="Diversified Agriculture">Diversified Agriculture</a>                    
                        <a href="#" class="drop-up-item" data-category="Specialty Crops">Specialty Crops</a>                    
                        <a href="#" class="drop-up-item" data-category="Organic Techniques">Organic Techniques</a>                
                    </div>            
                </div>


       
            </div>

                
            <div class="floating-icons">
                <div class="floating-icons">
                    <i class="fas fa-tint fa-2x floating-icon" style="--i:1;"></i>
                    <i class="fas fa-recycle fa-2x floating-icon" style="--i:2;"></i>
                    <i class="fas fa-solar-panel fa-2x floating-icon" style="--i:3;"></i>
                    <i class="fas fa-heartbeat fa-2x floating-icon" style="--i:4;"></i>
                    <i class="fas fa-leaf fa-2x floating-icon" style="--i:5;"></i>
                    <i class="fas fa-seedling fa-2x floating-icon" style="--i:6;"></i>
                    <i class="fas fa-water fa-2x floating-icon" style="--i:7;"></i>
                    <i class="fas fa-wind fa-2x floating-icon" style="--i:8;"></i>
                </div>
            </div>
        
        <div class="subheader">Appropriate Technology Videos for the DIY Sector</div>

        <div id="hero" class="aspect-w-16 aspect-h-9 mb-4">
        </div>
    
    </div>

        
    <div class="p-4 mt-4">

        <div class="mb-4 flex justify-center space-x-4">
          <a href="#" class="category-link bg-blue-500/50 hover:bg-blue-500/80 dark:text-white text-black font-semibold py-2 px-4 border-2 dark:border-white border-blue rounded-full shadow-sm transition duration-300 ease-in-out flex items-center" data-category="Drinking Water">
            <i class="fas fa-tint mr-2 text-xl"></i>
            <span>Drinking Water</span>
          </a>
          
          <a href="#" class="category-link bg-green-500/50 hover:bg-green-500/80 dark:text-white text-black font-semibold py-2 px-4 border-2 dark:border-white border-blue rounded-full shadow-sm transition duration-300 ease-in-out flex items-center" data-category="Waste Management">
            <i class="fas fa-recycle mr-2 text-xl"></i>
            <span>Waste Management</span>
          </a>
          
          <a href="#" class="category-link bg-yellow-500/50 hover:bg-yellow-500/80 dark:text-white text-black font-semibold py-2 px-4 border-2 dark:border-white border-blue rounded-full shadow-sm transition duration-300 ease-in-out flex items-center" data-category="Energy">
            <i class="fas fa-solar-panel mr-2 text-xl"></i>
            <span>Energy Systems</span>
          </a>
          
          <a href="#" class="category-link bg-red-500/50 hover:bg-red-500/80 dark:text-white text-black font-semibold py-2 px-4 border-2 dark:border-white border-blue rounded-full shadow-sm transition duration-300 ease-in-out flex items-center" data-category="Health">
            <i class="fas fa-heartbeat mr-2 text-xl"></i>
            <span>Appropriate Tech</span>
          </a>
        </div>



        <div class="mb-4">
            <input type="text" id="search" placeholder="Search videos..." class="w-full p-2 border rounded dark:bg-gray-700 dark:text-white">
        </div>


        <div id="mondrian-box" class="relative left-0 right-0 bg-white dark:bg-gray-800 p-4 hidden">
          <div id="subcategory-links" class="flex flex-wrap justify-center"></div>
        </div>


        
        <div id="categories" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    </div>

   <div id="video-detail" class="fixed inset-0 bg-opacity-50 overflow-y-auto h-full w-full hidden">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md">
        <div>
            
            <button id="close-detail-x" class="absolute top-2 right-2 text-white-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white">
                <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>

            <button id="edit-detail" class="absolute top-2 left-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200">
                <i class="fas fa-edit h-6 w-6"></i>
            </button>
            
        </div>
        <div class="curved-line"></div>
        <div class="curved-line"></div>
        <div class="curved-line"></div>
        <div class="curved-line"></div>
        <div id="video-content"></div>
        <div class="text-center mt-4">
            <button id="close-detail" class="px-4 py-2 bg-gray-500 text-white text-base font-medium rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300">
                Close
            </button>
        </div>
    </div>
</div>


<div id="add-content-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
            <h3 class="text-lg leading-6 font-medium text-gray-900">Add New Content</h3>
            <form id="add-content-form" class="mt-2 text-left">
                <div class="mb-4">
                    <label for="content-type" class="block text-gray-700 text-sm font-bold mb-2">Content Type</label>
                    <select id="content-type" name="content-type" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <option value="video">Video</option>
                        <option value="suggestion">Suggestion</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="title" class="block text-gray-700 text-sm font-bold mb-2">Title</label>
                    <input type="text" id="title" name="title" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                </div>
                <div class="mb-4">
                    <label for="description" class="block text-gray-700 text-sm font-bold mb-2">Description</label>
                    <textarea id="description" name="description" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" rows="3" required></textarea>
                </div>
                <div id="video-fields" class="mb-4">
                    <label for="video-url" class="block text-gray-700 text-sm font-bold mb-2">Video URL</label>
                    <input type="url" id="video-url" name="video-url" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="category" class="block text-gray-700 text-sm font-bold mb-2">Category</label>
                    <select id="category" name="category" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        <option value="">Select a category</option>
                        <option value="Drinking Water">Drinking Water</option>
                        <option value="Waste Management">Waste Management</option>
                        <option value="Energy Systems">Energy Systems</option>
                        <option value="Appropriate Tech">Appropriate Tech</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="tags" class="block text-gray-700 text-sm font-bold mb-2">Tags (comma-separated)</label>
                    <input type="text" id="tags" name="tags" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="flex items-center justify-between mt-4">
                    <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                        Submit
                    </button>
                    <button type="button" id="close-modal" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
    
        

<footer class="footer-gradient dark:footer-gradient-light text-gray-800 dark:text-gray-200 py-12 mt-12 transition-colors duration-300">
    <div  class="landscape">
        <img src="gyyy5r.webp" alt="Approvideo Sept 2024 - blocky landscape 0">
    </div>
    
    <div class="container mx-auto px-4">
        <div class="flex flex-wrap justify-between items-start">
            <div class="w-full md:w-1/3 mb-8 md:mb-0">
                <h3 class="footer-title mb-2 text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-green-500">ApproVideo</h3>
                <p class="footer-subtitle text-lg">Appropriate Technology Videos for the DIY Sector</p>
                <div class="mt-4 relative overflow-hidden cursor-pointer" id="mission-reveal">
                    <p class="text-sm font-semibold">Our Mission (Click to reveal)</p>
                    <div class="mission-text hidden mt-2 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg transform transition-all duration-500 ease-in-out">
                        <p>To empower individuals and communities with accessible, sustainable technology solutions through educational videos.</p>
                    </div>
                </div>
            </div>
            <div class="w-full md:w-1/3 mb-8 md:mb-0">
                <h4 class="text-xl font-semibold mb-4 text-blue-600 dark:text-blue-400">Quick Links</h4>
                <ul class="space-y-2">
                    <li><a href="https://github.com/yourusername/approtech" class="footer-link hover:text-green-500 transition duration-300 flex items-center"><i class="fab fa-github mr-2"></i>GitHub Repository</a></li>
                    <li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html" class="footer-link hover:text-green-500 transition duration-300 flex items-center"><i class="fas fa-balance-scale mr-2"></i>GPL v3 License</a></li>
                    <li><a href="https://scdhub.org" class="footer-link hover:text-green-500 transition duration-300 flex items-center"><i class="fas fa-globe mr-2"></i>SCD Hub Website</a></li>
                </ul>
            </div>

            <div class="w-full md:w-1/3 flex flex-col items-center md:items-end">
                <button id="sponsor-us" class="footer-button bg-gradient-to-r from-blue-500 to-green-500 hover:from-blue-600 hover:to-green-600 text-white font-bold py-3 px-6 rounded-full transition duration-300 mb-4 transform hover:scale-105">
                    Sponsor us!
                </button>
                <button id="be-an-editor" class="footer-button bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-6 rounded-full transform hover:scale-105 transition duration-300">
                    Be an editor
                </button>
            </div>


        </div>
        <div class="mt-12 pt-8 border-t border-gray-700 dark:border-gray-300 text-center text-sm">
            <p>&copy; 2024 ApproVideo. All rights reserved. | <a href="#" class="footer-link hover:text-blue-400 transition duration-300">Privacy Policy</a> | <a href="#" class="footer-link hover:text-blue-400 transition duration-300">Terms of Service</a></p>
            <p class="mt-2">A project of SCD Hub 501(c)(3)</p>
        </div>
    </div>



<div id="sponsor-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
            <h3 class="text-lg leading-6 font-medium text-gray-900">Sponsor ApproVideo</h3>
            <div class="mt-2 px-7 py-3">
                <p class="text-sm text-gray-500">
                    Help us continue providing valuable educational content on appropriate technology. Your sponsorship makes a difference!
                </p>
                <!-- Add sponsorship options or a form here -->
            </div>
            <div class="items-center px-4 py-3">
                <button id="close-sponsor-modal" class="px-4 py-2 bg-green-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-300">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>

<div id="editor-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
            <h3 class="text-lg leading-6 font-medium text-gray-900">Become an Editor</h3>
            <div class="mt-2 px-7 py-3">
                <p class="text-sm text-gray-500">
                    Join our team of editors and help curate high-quality content on appropriate technology. Share your expertise with the world!
                </p>
                  <form id="editor-login-form" class="space-y-4">
                    <div>
                        <label for="username" class="block text-sm font-medium text-gray-700">Username</label>
                        <input type="text" id="username" name="username" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700">Password</label>
                        <input type="password" id="password" name="password" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div>
                        <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            Login
                        </button>
                    </div>
                </form>
                <p id="login-message" class="mt-2 text-sm text-red-600 hidden"></p>
            </div>
            <div class="items-center px-4 py-3">
                <button id="close-editor-modal" class="px-4 py-2 bg-purple-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>
</footer>




<script>

    
    
    
    document.getElementById('add-content-form').addEventListener('submit', async function(event) {
    event.preventDefault(); // Prevent the form from submitting the traditional way

    // Gather form data
    const contentType = document.getElementById('content-type').value;
    const title = document.getElementById('title').value;
    const description = document.getElementById('description').value;
    const videoUrl = document.getElementById('video-url').value;
    const category = document.getElementById('category').value;
    const tags = document.getElementById('tags').value;

    // Prepare the request body
    const formData = {
      content_type: contentType,
      title: title,
      description: description,
      video_url: contentType === 'video' ? videoUrl : null, // Only include video URL if the content type is video
      category: category,
      tags: tags.split(',').map(tag => tag.trim()) // Split tags into an array
    };

    try {
      // Send POST request to your API
      const response = await fetch('/api/videos3.js', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer YOUR_TOKEN_HERE`, // Replace with actual token
        },
        body: JSON.stringify(formData),
      });

      // Handle the response
      if (response.ok) {
        const result = await response.json();
        alert('Content added successfully!');
        console.log('Success:', result);
        // You can reset the form here if needed
        document.getElementById('add-content-form').reset();
      } else {
        const error = await response.json();
        alert('Failed to add content: ' + error.error);
        console.log('Error:', error);
      }
    } catch (error) {
      console.error('Error:', error);
      alert('An error occurred while adding content.');
    }
  });

function toggleSublinks(category) {
  const dropUpMenus = document.querySelectorAll('.drop-up-menu');
  dropUpMenus.forEach(menu => {
    const parentCategory = menu.closest('.group').querySelector('a').getAttribute('data-category');
    if (parentCategory === category) {
      menu.classList.toggle('hidden');
    } else {
      menu.classList.add('hidden'); // Hide other menus
    }
  });
}

    
function renderStars(rating) {
    const fullStars = Math.floor(rating);
    const halfStar = rating % 1 >= 0.5 ? 1 : 0;
    const emptyStars = 5 - fullStars - halfStar;
    return '★'.repeat(fullStars) + (halfStar ? '½' : '') + '☆'.repeat(emptyStars);
}


function setupFloatingIcons() {
    const header = document.querySelector('.header');
    const icons = document.querySelectorAll('.floating-icon');
    
    icons.forEach((icon, index) => {
        icon.style.left = `${Math.random() * 100}%`;
        icon.style.top = `${Math.random() * 100}%`;
        
        setTimeout(() => {
            icon.classList.add('active');
        }, 1400 + (index * 100)); // Staggered delay starting at 1.4 seconds
    });

    header.addEventListener('mousemove', (e) => {
        const { left, top, width, height } = header.getBoundingClientRect();
        const x = (e.clientX - left) / width - 0.5;
        const y = (e.clientY - top) / height - 0.5;

        icons.forEach((icon) => {
            const speed = parseFloat(icon.style.getPropertyValue('--i')) * 2;
            const rotateX = y * speed;
            const rotateY = -x * speed;
            const translateZ = Math.abs(x * y) * 50;
            icon.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(${translateZ}px)`;
        });
    });

    header.addEventListener('mouseleave', () => {
        icons.forEach((icon) => {
            icon.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) translateZ(0)';
        });
    });
}


function setupVideoDetailListeners() {
    document.querySelectorAll('.video-detail-link').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const videoId = this.getAttribute('data-id');
            const video = window.videoData.find(v => v.id === videoId);
            if (video) {
                document.getElementById('video-content').innerHTML = renderVideoDetails(video);
                document.getElementById('video-detail').classList.remove('hidden');
                // Load a new background image each time the modal is opened
                document.getElementById('video-detail').style.backgroundImage = `url('https://source.unsplash.com/1600x900/?sky,night,stars&random=${new Date().getTime()}')`;
                setupPanelNavigation();
            }
        });
    });
}

  
function setupPanelNavigation() {
    const panels = document.querySelectorAll('.info-panel');
    const prevBtn = document.getElementById('prev-panel');
    const nextBtn = document.getElementById('next-panel');
    let currentPanel = 0;

    function updatePanels() {
        panels.forEach((panel, index) => {
            panel.classList.toggle('active', index === currentPanel);
        });
        prevBtn.disabled = currentPanel === 0;
        nextBtn.disabled = currentPanel === panels.length - 1;
    }

    prevBtn.addEventListener('click', () => {
        if (currentPanel > 0) {
            currentPanel--;
            updatePanels();
        }
    });

    nextBtn.addEventListener('click', () => {
        if (currentPanel < panels.length - 1) {
            currentPanel++;
            updatePanels();
        }
    });

    updatePanels();
}

  document.getElementById('content-type').addEventListener('change', function() {
    const videoFields = document.getElementById('video-fields');
    if (this.value === 'video') {
      videoFields.style.display = 'block';
    } else {
      videoFields.style.display = 'none';
    }
  });


                            
function setupEventListeners() {
    document.getElementById('search').addEventListener('input', filterAndSortVideos);
    document.getElementById('categories').addEventListener('click', handleVideoDetailClick);
    document.getElementById('close-detail').addEventListener('click', closeVideoDetail);
    document.querySelectorAll('.category-link').forEach(link => {
        link.addEventListener('click', handleCategoryClick);
    });

     // Single event listener on the header for both main categories and dropdown items
      document.querySelector('.header').addEventListener('click', (e) => {
        const target = e.target.closest('a');
    
        if (target) {
          e.preventDefault();

        
        if (target.classList.contains('category-link')) {
          const category = target.getAttribute('data-category');
          toggleSublinks(category); // Toggle sublinks
        } else if (target.classList.contains('drop-up-item')) {
          const category = target.getAttribute('data-category');
          const tag = target.getAttribute('data-tag');
    
          // Update URL and filter videos
          const urlParams = new URLSearchParams(window.location.search);
          urlParams.set('category', category);
          urlParams.set('tag', tag);
          history.pushState(null, '', `?${urlParams.toString()}`);
          filterAndSortVideos();
        const heroVideo = document.getElementById('hero-video');
        if (heroVideo) {
            heroVideo.style.display = 'none';
        }
    
    
          // Hide the dropdown after clicking a sublink
          target.closest('.drop-up-menu').classList.add('hidden'); 
        }
        
          let category, tag;
          if (target.classList.contains('category-link')) {
            category = target.getAttribute('data-category');
          } else if (target.classList.contains('drop-up-item')) {
            category = target.getAttribute('data-category');
            tag = target.getAttribute('data-tag');
          }

            if (category) {
              // Clear the search field
              const searchInput = document.getElementById('search');
              if (searchInput) {
                searchInput.value = '';
              }
         }
            
          // Update URL and filter videos
          const urlParams = new URLSearchParams(window.location.search);
          if (tag) {
            urlParams.set('tag', tag);
          } else {
            urlParams.delete('tag'); 
          }
          history.pushState(null, '', `?${urlParams.toString()}`);
          filterAndSortVideos();
        const heroVideo = document.getElementById('hero-video');
        if (heroVideo) {
            heroVideo.style.display = 'none';
        }
    
        }
      });


    
    setupThemeToggle();

    // Handle initial page load with URL parameters
    filterAndSortVideos();
        const heroVideo = document.getElementById('hero-video');
        if (heroVideo) {
            heroVideo.style.display = 'none';
        }
    
    
}

function slugify(text) {
    return text.toString().toLowerCase()
        .replace(/\s+/g, '-')
        .replace(/[^\w\-]+/g, '')
        .replace(/\-\-+/g, '-')
        .replace(/^-+/, '')
        .replace(/-+$/, '');
}


let isAuthenticated = false;

function renderVideo(video) {
    const mainCategory = video.categories[0];
    const mainTag = video.tags[0];
    const detailUrl = `/${slugify(mainCategory)}/${slugify(mainTag)}/${slugify(video.title)}`;
    
    return `
        <div class="video-card rounded-lg shadow-md p-4 mb-4">
            <h3 class="text-xl font-semibold mb-2">${video.title}</h3>
            <div class="aspect-w-16 aspect-h-9 mb-2">
                <img src="https://img.youtube.com/vi/${video.youtubeId}/0.jpg" alt="${video.title}" class="w-full h-64 object-cover">
            </div>
            <p class="mb-2">${video.description}</p>
            <div class="flex flex-wrap mb-2">
                ${video.tags.map(tag => `
                    <a href="#" class="video-tag tag text-sm font-medium mr-2 mb-2 px-2.5 py-0.5 rounded cursor-pointer bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors duration-200" data-tag="${tag}">
                        ${tag}
                    </a>
                `).join('')}
            </div>
            <div class="text-yellow-400">${renderStars(video.rating)}</div>
            <div class="text-sm opacity-75">Date: ${video.date}</div>
            <a href="${detailUrl}" class="mt-2 inline-block bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 video-detail-link" data-id="${video.id}">View Details</a>
            ${isAuthenticated ? `<a href="#" class="edit-link mt-2 inline-block bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600" data-id="${video.id}">Edit</a>` : ''}
        </div>
    `;
}

function setupModals() {
    const sponsorButton = document.getElementById('sponsor-us');
    const editorButton = document.getElementById('be-an-editor');
    const sponsorModal = document.getElementById('sponsor-modal');
    const editorModal = document.getElementById('editor-modal');
    const closeSponsorModal = document.getElementById('close-sponsor-modal');
    const closeEditorModal = document.getElementById('close-editor-modal');

    function openModal(modal) {
        modal.classList.remove('hidden');
        setTimeout(() => {
            modal.classList.add('show');
        }, 10);
    }

    function closeModal(modal) {
        modal.classList.remove('show');
        setTimeout(() => {
            modal.classList.add('hidden');
        }, 300);
    }

    sponsorButton.addEventListener('click', () => openModal(sponsorModal));
    editorButton.addEventListener('click', () => openModal(editorModal));
    closeSponsorModal.addEventListener('click', () => closeModal(sponsorModal));
    closeEditorModal.addEventListener('click', () => closeModal(editorModal));

    // Close modal when clicking outside
    window.addEventListener('click', (e) => {
        if (e.target === sponsorModal) closeModal(sponsorModal);
        if (e.target === editorModal) closeModal(editorModal);
    });
}







function setupTagListeners() {
    document.querySelectorAll('.video-tag').forEach(tagLink => {
        tagLink.addEventListener('click', function(e) {
            e.preventDefault();
            const tag = this.getAttribute('data-tag');
            filterByTag(tag);
        });
    });
}

function filterByTag(tag) {
    const urlParams = new URLSearchParams(window.location.search);
    urlParams.set('tag', tag);
    history.pushState(null, '', `?${urlParams.toString()}`);
    filterAndSortVideos();
        const heroVideo = document.getElementById('hero-video');
        if (heroVideo) {
            heroVideo.style.display = 'none';
        }
    
}

    
    
function renderVideoDetails(video) {

    let detailsHTML = `
         <h1 class="text-3xl font-bold mb-4 text-orange-700 dark:text-blue-400">${video.title}</h1>
        <div class="aspect-w-16 aspect-h-9 mb-4">
            <iframe src="https://www.youtube.com/embed/${video.youtubeId}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen class="w-full h-96"></iframe>
        </div>
        <p class="mb-4 text-gray-700 dark:text-gray-300">${video.description}</p>
        <div class="mb-4">
            ${video.tags.map(tag => `<span class="tag text-sm font-medium mr-2 px-2.5 py-0.5 rounded cursor-pointer bg-orange-100 text-orange-800 dark:bg-gray-700 dark:text-blue-300">${tag}</span>`).join('')}
        </div>
        <div class="text-yellow-600 dark:text-yellow-400 mb-2">${renderStars(video.rating)}</div>
        <p class="text-sm opacity-75 mb-4 text-gray-600 dark:text-gray-400">Date: ${video.date}</p>

        <h2 class="text-2xl font-bold mb-2 text-orange-700 dark:text-blue-400">Materials Needed:</h2>
        <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300">
            ${video.materials?.map(material => `<li>${material}</li>`).join('') ?? 'No materials data' }    
        </ul>

        <h2 class="text-2xl font-bold mb-2 text-orange-700 dark:text-blue-400">Steps:</h2>
        <ol class="list-decimal list-inside mb-4 text-gray-700 dark:text-gray-300">
            ${video.steps?.map(step => `<li>${step}</li>`).join('') ?? 'No steps data' }
        </ol>

        <h2 class="text-2xl font-bold mb-2 text-orange-700 dark:text-blue-400">Transcript:</h2>
        <p class="mb-4 text-gray-700 dark:text-gray-300">${video.transcript}</p>
    `;


    if (video.panels && video.panels.length > 0) {
        detailsHTML += `
            <h2 class="text-2xl font-bold mb-2">Additional Information:</h2>
            <div class="panel-container">
                ${video.panels.map((panel, index) => `
                    <div class="info-panel ${index === 0 ? 'active' : ''}" data-panel-index="${index}">
                        <h3 class="text-lg font-semibold mb-2">${panel.title}</h3>
                        <p class="text-sm">${panel.content}</p>
                        <i class="panel-icon fas fa-${getPanelIcon(panel.title)}"></i>
                    </div>
                `).join('')}
            </div>
            <div class="panel-nav">
                <button id="prev-panel" disabled>Previous</button>
                <button id="next-panel" ${video.panels.length > 1 ? '' : 'disabled'}>Next</button>
            </div>
        `;
    }

    return detailsHTML;
}


// 1. Load YouTube Iframe API script
let player; // Declare the player variable globally

function onYouTubeIframeAPIReady() {
  // Create the YouTube player when the API is ready
  player = new YT.Player('hero-video', {
    height: '390',
    width: '640',
    videoId: 'YOUR_VIDEO_ID',
    playerVars: {
      autoplay: 1,
      mute: 1,
      loop: 1,
      playlist: 'YOUR_VIDEO_ID', // Ensure continuous looping
    },
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });
}

function onPlayerReady(event) {
  // Play the video when it's ready
  event.target.playVideo();
}

function onPlayerStateChange(event) {
  // If the video ends, restart it (for continuous loop)
  if (event.data == YT.PlayerState.ENDED) {
    player.playVideo(); 
  }
}

// 2. Modify renderHeroSection
function renderHeroSection() {
  const heroContainer = document.getElementById('hero');
  if (isUserAuthenticated()) {
    // User is authenticated, create a container for the YouTube player
    heroContainer.innerHTML = `
      <div id="hero-video"></div> 
      <p id="adblock-message" class="hidden text-red-500">
        Video might be blocked by an ad blocker. 
        <a href="https://www.youtube.com/watch?v=YOUR_VIDEO_ID" target="_blank" class="text-blue-500 underline">
          Watch on YouTube
        </a>
      </p>
    `;

    // Load the IFrame Player API code asynchronously
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    const firstScriptTag = document.getElementsByTagName('script')[0];  

    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);  

  } else {
    // User is not authenticated, display a link
    heroContainer.innerHTML = `
      <a href="/login" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
        Login to view video
      </a>
    `;
  }
}

// 3. Handle potential ad-blocking (similar to previous example)

function handleEmbedLoad() {
  const iframe = document.querySelector('#hero-video iframe');
  const adblockMessage = document.getElementById('adblock-message');

  // Check if the iframe content is empty (potential ad-block)
  if (iframe && iframe.contentDocument && iframe.contentDocument.body.innerHTML.trim() === '') {
      adblockMessage.classList.remove('hidden'); // Show the ad-block message
  }
}


function getPanelIcon(title) {
    const iconMap = {
        'Temperature Control': 'thermometer-half',
        'Moisture Management': 'tint',
        'Pile Location': 'map-marker-alt',
        'Aeration': 'wind',
        'Function of a First Flush Diverter': 'filter',
        'Choosing the Right Size': 'ruler',
        'Maintenance Tips': 'tools',
        'Safety Precautions': 'hard-hat'
    };
    return iconMap[title] || 'info-circle';
}


function renderCategories(videos) {
    const categoriesContainer = document.getElementById('categories');
    if (videos.length === 0) {
        categoriesContainer.innerHTML = '<p class="text-center text-gray-500">No videos found. Try adjusting your search.</p>';
    } else {
        categoriesContainer.innerHTML = videos.map(renderVideo).join('');
        setupTagListeners(); // Add this line to set up the tag listeners after rendering
    }
    setupVideoDetailListeners();
}

function filterAndSortVideos() {
    const searchTerm = document.getElementById('search').value.toLowerCase();
    const urlParams = new URLSearchParams(window.location.search);
    const category = urlParams.get('category');
    const tag = urlParams.get('tag');

    let filteredVideos = window.videoData.filter(video => {
        // Check if video matches the category or tag (if specified)
        const categoryMatch = !category || video.categories.some(cat => cat.toLowerCase().includes(category.toLowerCase()));
        const tagMatch = !tag || video.tags.some(t => t.toLowerCase().includes(tag.toLowerCase()));

        // Check if video matches the search term
        const searchMatch = 
            video.title.toLowerCase().includes(searchTerm) ||
            video.description.toLowerCase().includes(searchTerm) ||
            video.categories.some(cat => cat.toLowerCase().includes(searchTerm)) ||
            video.tags.some(t => t.toLowerCase().includes(searchTerm));

        // Return true if the video matches the search term AND (matches category OR tag OR neither are specified)
        return searchMatch && (categoryMatch || tagMatch || (!category && !tag));
    });

    // Sort videos by rating (assuming higher rating is better)
    filteredVideos.sort((a, b) => b.rating - a.rating);

    renderCategories(filteredVideos);
}

function renderCategories(videos) {
    const categoriesContainer = document.getElementById('categories');
    if (videos.length === 0) {
        categoriesContainer.innerHTML = '<p class="text-center text-gray-500">No videos found. Try adjusting your search.</p>';
    } else {
        categoriesContainer.innerHTML = videos.map(renderVideo).join('');
    }
    setupVideoDetailListeners();
}
function handleVideoDetailClick(e) {
    if (e.target.classList.contains('video-detail-link')) {
        e.preventDefault();
        const videoId = e.target.getAttribute('data-id');
        const video = window.videoData.find(v => v.id === videoId);
        if (video) {
            document.getElementById('video-content').innerHTML = renderVideoDetails(video);
            document.getElementById('video-detail').classList.remove('hidden');
            setupPanelNavigation();
        }
    }
}

function closeVideoDetail() {
    document.getElementById('video-detail').classList.add('hidden');
}

function handleCategoryClick(e) {
    e.preventDefault();
    const category = this.getAttribute('data-category');
    history.pushState(null, '', `?category=${category}`);
    filterAndSortVideos();
        const heroVideo = document.getElementById('hero-video');
        if (heroVideo) {
            heroVideo.style.display = 'none';
        }
    
}

function setupThemeToggle() {
    const themeToggleBtn = document.getElementById('theme-toggle');
    const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
    const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

    function setTheme(isDark) {
        document.body.classList.remove(isDark ? 'light' : 'dark');
        document.body.classList.add(isDark ? 'dark' : 'light');
        themeToggleDarkIcon.classList.toggle('hidden', !isDark);
        themeToggleLightIcon.classList.toggle('hidden', isDark);

        // Force a repaint of the video detail overlay if it's open
        const videoDetail = document.getElementById('video-detail');
        if (!videoDetail.classList.contains('hidden')) {
            videoDetail.style.display = 'none';
            videoDetail.offsetHeight; // Force a repaint
            videoDetail.style.display = '';
        }

        // Store the user's preference
        localStorage.setItem('darkMode', isDark);
    }

    function toggleTheme() {
        const isDark = document.body.classList.contains('dark');
        setTheme(!isDark);
    }

    // Check for saved user preference
    const savedDarkMode = localStorage.getItem('darkMode');
    if (savedDarkMode !== null) {
        setTheme(JSON.parse(savedDarkMode));
    } else {
        const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
        setTheme(prefersDarkScheme.matches);
    }

    themeToggleBtn.addEventListener('click', toggleTheme);
}




    document.getElementById('edit-detail').addEventListener('click', function() {
        const videoId = this.closest('#video-detail').getAttribute('data-video-id');
        console.log('Edit video with ID:', videoId);
        // Implement your edit functionality here
    });

    // Add content button
    document.getElementById('add-content').addEventListener('click', function() {
        console.log('Add new content');
        // Implement your add content functionality here
    });


    

// Initial setup
document.addEventListener('DOMContentLoaded', () => {
    const missionReveal = document.getElementById('mission-reveal');
    const missionText = missionReveal.querySelector('.mission-text');
    const addContentButton = document.getElementById('add-content');
    const addContentModal = document.getElementById('add-content-modal');
    const closeModalButton = document.getElementById('close-modal');
    const addContentForm = document.getElementById('add-content-form');
    const contentTypeSelect = document.getElementById('content-type');
    const videoFields = document.getElementById('video-fields');


    if (typeof setupModals === 'function') {
        setupModals();
    } else {
        console.error('setupModals function not found. Make sure modalinteractions.js is loaded correctly.');
    }


    addContentButton.addEventListener('click', () => {
        addContentModal.classList.remove('hidden');
    });

    closeModalButton.addEventListener('click', () => {
        addContentModal.classList.add('hidden');
    });

    contentTypeSelect.addEventListener('change', () => {
        if (contentTypeSelect.value === 'video') {
            videoFields.style.display = 'block';
        } else {
            videoFields.style.display = 'none';
        }
    });

    addContentForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const formData = new FormData(addContentForm);
        const data = Object.fromEntries(formData.entries());
        
        // Here you would typically send this data to your server or Supabase
        console.log('Form data:', data);
        
        // For demonstration, we'll just log it and close the modal
        alert('Content submitted successfully!');
        addContentModal.classList.add('hidden');
        addContentForm.reset();
    });
    

    function closeVideoDetail() {
        document.getElementById('video-detail').classList.add('hidden');
    }

    // Existing close button
    document.getElementById('close-detail').addEventListener('click', closeVideoDetail);

    // New close button (X)
    document.getElementById('close-detail-x').addEventListener('click', closeVideoDetail);

    
    document.body.addEventListener('click', (e) => {
        const target = e.target.closest('a');
        if (!target) return;

        e.preventDefault();

        let category, tag;

        if (target.closest('.header')) {
            // Header links
            if (target.classList.contains('drop-up-item')) {
                category = target.closest('.group').querySelector('a').getAttribute('data-category');
                tag = target.textContent.trim();
            } else {
                category = target.getAttribute('data-category');
                toggleSublinks(category);
                return; // Exit early for main category toggles
            }
        } else if (target.classList.contains('category-link')) {
            // Bottom category links
            category = target.getAttribute('data-category');
        }

        if (category) {
            const urlParams = new URLSearchParams(window.location.search);
            urlParams.set('category', category);
            if (tag) {
                urlParams.set('tag', tag);
            } else {
                urlParams.delete('tag');
            }
            history.pushState(null, '', `?${urlParams.toString()}`);
            filterAndSortVideos();
        const heroVideo = document.getElementById('hero-video');
        if (heroVideo) {
            heroVideo.style.display = 'none';
        }
    

            // Hide all dropdowns
            document.querySelectorAll('.drop-up-menu').forEach(menu => menu.classList.add('hidden'));
        }
    });

    
    missionReveal.addEventListener('click', () => {
        missionText.classList.toggle('hidden');
        missionText.classList.toggle('active');
    });

    // Hover effect for links
    const links = document.querySelectorAll('.footer-link');
    links.forEach(link => {
        link.addEventListener('mouseenter', () => {
            link.style.transform = 'translateX(5px)';
        });
        link.addEventListener('mouseleave', () => {
            link.style.transform = 'translateX(0)';
        });
    });
    
      console.log('DOM fully loaded');
      console.log(window.videoData);
      filterAndSortVideos();
        const heroVideo = document.getElementById('hero-video');
        if (heroVideo) {
            heroVideo.style.display = 'none';
        }
    
         document.getElementById('search').addEventListener('input', filterAndSortVideos);
      setupEventListeners();
      setupFloatingIcons();
      setupModals();
            
        window.renderVideo = renderVideo;
        window.filterAndSortVideos = filterAndSortVideos;
        window.isAuthenticated = isAuthenticated;

 });
</script>
    
<script src="prodnav.js"></script>
<script src="videoplayer.js"></script>
</body>
</html>

